import{b as q}from"./chunk-Y45U2NPN.js";import{b as M}from"./chunk-XRY6KIPZ.js";import{l as D}from"./chunk-5TB5GV2Z.js";import"./chunk-GOYYEOLK.js";import{Ib as Q,Lb as k,V as I,nb as R,qa as N,yb as B}from"./chunk-BJS2GJXO.js";import{Cc as S,Dc as F,Fa as l,Ga as c,Ia as T,Ib as v,Mb as w,Ob as m,Ub as a,Vc as V,bc as b,gc as s,hc as u,ic as x,j as C,mc as _,pc as f,rc as r,ua as z,vb as p,wc as h,xc as y,yc as g,zd as E}from"./chunk-DNCYZTAJ.js";var P=["toolbar"],j=["editor"];function L(o,t){if(o&1){let e=_();s(0,"smart-toolbar",6,2),f("action",function(n){l(e);let d=r(3);return c(d.execute(n))}),u()}if(o&2){let e=r(3);a("fields",e.content.toolbar)("values",e.toolbarValue)}}function G(o,t){if(o&1){let e=_();s(0,"button",7),f("click",function(){l(e);let n=r(3);return c(n.submit())}),x(1,"span",8),F(2," \u63D0\u4EA4 "),u()}if(o&2){let e=r(3);p(),a("nzSpin",e.submitting)}}function H(o,t){if(o&1){let e=_();s(0,"nz-card",4),m(1,L,2,2,"smart-toolbar",5),s(2,"smart-editor",6,0),f("action",function(n){l(e);let d=r(2);return c(d.execute(n))}),u()(),m(4,G,3,1,"ng-template",null,1,V)}if(o&2){let e=S(5),i=r(2);a("nzTitle",i.content.title)("nzExtra",e),p(),a("ngIf",i.content.toolbar),p(),a("fields",i.content.fields)("values",i.data)}}function J(o,t){o&1&&F(0," \u6A21\u677F\u7C7B\u578B\u5E94\u8BE5\u662Fform ")}function K(o,t){if(o&1&&m(0,H,6,5)(1,J,1,0),o&2){let e=r();b(e.content.template=="form"?0:1)}}function O(o,t){o&1&&x(0,"nz-spin",3)}var A=class o extends M{modalRef=z(Q,{optional:!0});toolbar;editor;toolbarValue={};submitting=!1;submit(){if(this.submitting)return;console.log("[form] submit",this.page);let t=this.content;if(t){if(typeof t.submit=="string"&&t.submit.length>0)try{t.submit=new Function("data",t.submit)}catch(e){console.error(e)}if(C(t.submit))this.submitting=!0,t.submit.call(this,this.data).then(e=>{}).finally(()=>{this.submitting=!1});else if(t.submit_api){this.submitting=!0;let e=k(t.submit_api,this.params);this.request.post(e,this.editor.value).subscribe(i=>{if(!i.error){if(this.data=i.data,typeof t.submit_success=="string"&&t.submit_success.length>0)try{t.submit_success=new Function("data",t.submit_success)}catch(n){console.error(n)}C(t.submit_success)&&t.submit_success.call(this,this.data),this.modalRef&&!this.isChild&&this.modalRef.close()}}).add(()=>{this.submitting=!1})}}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=T(o)))(i||o)}})();static \u0275cmp=v({type:o,selectors:[["app-form"]],viewQuery:function(e,i){if(e&1&&(h(P,5),h(j,5)),e&2){let n;y(n=g())&&(i.toolbar=n.first),y(n=g())&&(i.editor=n.first)}},features:[w],decls:2,vars:1,consts:[["editor",""],["extra",""],["toolbar",""],["nzSimple",""],[3,"nzTitle","nzExtra"],[3,"fields","values","action",4,"ngIf"],[3,"action","fields","values"],["nz-button","","nzType","text","nzType","primary",3,"click"],["nz-icon","","nzType","save",3,"nzSpin"]],template:function(e,i){e&1&&m(0,K,2,1)(1,O,1,0,"nz-spin",3),e&2&&b(i.content?0:1)},dependencies:[D,I,R,B,N,q,E],encapsulation:2})};export{A as FormComponent};
